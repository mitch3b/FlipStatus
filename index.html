<!DOCTYPE html>
<html>
<head>
<script src="utils.js"></script>
<link rel="stylesheet" href="style.css">

<script type="text/javascript">
  let displayData = new Map([Map]);
  loadData();

  function loadData() {
    let topAlbumsMap = new Map([Array]);
    topAlbumsMap.set("Pink Floyd", ["Dark Side of the Moon","The Wall","Wish You Were Here"]);
    topAlbumsMap.set("Neutral Milk Hotel", ["Aeroplane over the Sea"]);
    topAlbumsMap.set("Beatles", ["Abbey Road","Let it Be","White Album"]);
    displayData.set("Best Albums by", topAlbumsMap);

    let thanksMap = new Map([Array]);
    thanksMap.set("Bits", ["AceEbb","DaviDeil","Gromfalloon","NobodySgt","NotNobodySgt","Protokitty","Sambo140","Substylee"]);
    thanksMap.set("Donation", ["Gromfalloon"]);
    thanksMap.set("Subcription", ["DaviDeil","Mazimov","phunqsauce","Beerfullofbelly","angrylanks","Tarbash","chrisHgames","Backslash","CantFindBombs","rufford","Gromfalloon","NobodySgt"]);
    displayData.set("Thanks for the", thanksMap);
  }

  //Need at least 1 value
  let subjects = [...displayData.keys()]
  let categoryMap = displayData.get(subjects[1]);
  let categoryNames = [...categoryMap.keys()];
  let names = categoryMap.get(categoryNames[1]);

  var id = 'frontName';
  var currentIndex = 1; //Need mod for length 1 case

  function nextName() {
    currentIndex++;
    if(currentIndex == names.length) {
      currentIndex = 0;
      flipCategory();
    }

    var card = document.getElementById('nameCard');
    card.toggleClassName('flipped');

    var nextFront = (id == 'frontName');
    id = (nextFront) ? 'backName' : 'frontName';

    //Note this assumes there's only one.
    document.getElementById(id).innerHTML = names[currentIndex];
  }

  var categoryId = 'frontCategory';
  var currentCategory = 1;

  function flipCategory() {
    currentCategory++;
    if(currentCategory == categoryNames.length) {
      currentCategory = 1;
      flipSubject();
    }

    names = categoryMap.get(categoryNames[currentCategory]);

    var card = document.getElementById('categoryCard');
    card.toggleClassName('flipped');

    var nextFront = (categoryId == 'frontCategory');
    categoryId = (nextFront) ? 'backCategory' : 'frontCategory';

    //Note this assumes there's only one.
    document.getElementById(categoryId).innerHTML = categoryNames[currentCategory];
  }

  var subjectId = 'frontSubject';
  var currentSubject = 1;
  function flipSubject() {
    currentSubject++;
    if(currentSubject == subjects.length) {
      currentSubject = 1;
    }

    names = categoryMap.get(categoryNames[currentCategory]);
    categoryMap = displayData.get(subjects[currentSubject]);
    categoryNames = [...categoryMap.keys()];

    var card = document.getElementById('subjectCard');
    card.toggleClassName('flipped');

    var nextFront = (subjectId == 'frontSubject');
    subjectId = (nextFront) ? 'backSubject' : 'frontSubject';

    //Note this assumes there's only one.
    document.getElementById(subjectId).innerHTML = subjects[currentSubject];
  }

  window.setInterval(nextName, 1500);
</script>

</head>
<body>
  <div class="container">
    <div class="card" id="subjectCard">
      <div class="front" id="frontSubject">SHOULD NOT SEE THIS EVER</div>
      <div class="back" id="backSubject">SHOULD NOT SEE THIS EVER</div>
    </div>
  </div>
  <div class="container">
    <div class="card" id="categoryCard">
      <div class="front" id="frontCategory">SHOULD NOT SEE THIS EVER</div>
      <div class="back" id="backCategory">SHOULD NOT SEE THIS EVER</div>
    </div>
  </div>
  <div class="container">
    <div class="card" id="nameCard">
      <div class="front" id="frontName">SHOULD NOT SEE THIS EVER</div>
      <div class="back" id="backName">SHOULD NOT SEE THIS EVER</div>
    </div>
  </div>
  <!--button id="flip">Flip Card</button-->
</div>
<script type="text/javascript">
  var init = function() {
    document.getElementById('frontName').innerHTML = names[0];
    document.getElementById('frontCategory').innerHTML = categoryNames[1];
    document.getElementById('frontSubject').innerHTML = [...displayData.keys()][1];
  };

  window.addEventListener('DOMContentLoaded', init(), false);

</script>
</body>
</html>
